{"ast":null,"code":"import _regeneratorRuntime from \"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _asyncToGenerator from \"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/src/views/ExternalApi.js\";\n\nimport React, { useState } from \"react\";\nimport { Button, Alert } from \"reactstrap\";\nimport Highlight from \"../components/Highlight\";\nimport { useAuth0, withAuthenticationRequired } from \"@auth0/auth0-react\";\nimport { getConfig } from \"../config\";\nimport Loading from \"../components/Loading\";\nexport var ExternalApiComponent = function ExternalApiComponent() {\n  var _getConfig = getConfig(),\n      _getConfig$apiOrigin = _getConfig.apiOrigin,\n      apiOrigin = _getConfig$apiOrigin === void 0 ? \"http://localhost:3001\" : _getConfig$apiOrigin,\n      audience = _getConfig.audience;\n\n  var _useState = useState({\n    showResult: false,\n    apiMessage: \"\",\n    error: null\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var _useAuth = useAuth0(),\n      getAccessTokenSilently = _useAuth.getAccessTokenSilently,\n      loginWithPopup = _useAuth.loginWithPopup,\n      getAccessTokenWithPopup = _useAuth.getAccessTokenWithPopup;\n\n  var handleConsent = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getAccessTokenWithPopup();\n\n            case 3:\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                error: null\n              }));\n              _context.next = 9;\n              break;\n\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](0);\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                error: _context.t0.error\n              }));\n\n            case 9:\n              _context.next = 11;\n              return callApi();\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 6]]);\n    }));\n\n    return function handleConsent() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleLoginAgain = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return loginWithPopup();\n\n            case 3:\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                error: null\n              }));\n              _context2.next = 9;\n              break;\n\n            case 6:\n              _context2.prev = 6;\n              _context2.t0 = _context2[\"catch\"](0);\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                error: _context2.t0.error\n              }));\n\n            case 9:\n              _context2.next = 11;\n              return callApi();\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 6]]);\n    }));\n\n    return function handleLoginAgain() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var callApi = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var token, response, responseData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return getAccessTokenSilently();\n\n            case 3:\n              token = _context3.sent;\n              _context3.next = 6;\n              return fetch(\"\".concat(apiOrigin, \"/api/external\"), {\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n\n            case 6:\n              response = _context3.sent;\n              _context3.next = 9;\n              return response.json();\n\n            case 9:\n              responseData = _context3.sent;\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                showResult: true,\n                apiMessage: responseData\n              }));\n              _context3.next = 16;\n              break;\n\n            case 13:\n              _context3.prev = 13;\n              _context3.t0 = _context3[\"catch\"](0);\n              setState(_objectSpread(_objectSpread({}, state), {}, {\n                error: _context3.t0.error\n              }));\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[0, 13]]);\n    }));\n\n    return function callApi() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handle = function handle(e, fn) {\n    e.preventDefault();\n    fn();\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mb-5\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }, state.error === \"consent_required\" && /*#__PURE__*/React.createElement(Alert, {\n    color: \"warning\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  }, \"You need to\", \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#/\",\n    class: \"alert-link\",\n    onClick: function onClick(e) {\n      return handle(e, handleConsent);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }\n  }, \"consent to get access to users api\")), state.error === \"login_required\" && /*#__PURE__*/React.createElement(Alert, {\n    color: \"warning\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 11\n    }\n  }, \"You need to\", \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#/\",\n    class: \"alert-link\",\n    onClick: function onClick(e) {\n      return handle(e, handleLoginAgain);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, \"log in again\")), /*#__PURE__*/React.createElement(\"h1\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, \"External API\"), /*#__PURE__*/React.createElement(\"p\", {\n    className: \"lead\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, \"Ping an external API by clicking the button below.\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }, \"This will call a local API on port 3001 that would have been started if you run \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 22\n    }\n  }, \"npm run dev\"), \". An access token is sent as part of the request's `Authorization` header and the API will validate it using the API's audience value.\"), !audience && /*#__PURE__*/React.createElement(Alert, {\n    color: \"warning\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }, \"You can't call the API at the moment because your application does not have any configuration for \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 46\n    }\n  }, \"audience\"), \", or it is using the default value of \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 42\n    }\n  }, \"YOUR_API_IDENTIFIER\"), \". You might get this default value if you used the \\\"Download Sample\\\" feature of\", \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"https://auth0.com/docs/quickstart/spa/react\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 15\n    }\n  }, \"the quickstart guide\"), \", but have not set an API up in your Auth0 Tenant. You can find out more information on\", \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"https://auth0.com/docs/api\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 15\n    }\n  }, \"setting up APIs\"), \" in the Auth0 Docs.\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, \"The audience is the identifier of the API that you want to call (see\", \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"https://auth0.com/docs/get-started/dashboard/tenant-settings#api-authorization-settings\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 15\n    }\n  }, \"API Authorization Settings\"), \" \", \"for more info).\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, \"In this sample, you can configure the audience in a couple of ways:\"), /*#__PURE__*/React.createElement(\"ul\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 15\n    }\n  }, \"in the \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 24\n    }\n  }, \"src/index.js\"), \" file\"), /*#__PURE__*/React.createElement(\"li\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 15\n    }\n  }, \"by specifying it in the \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 41\n    }\n  }, \"auth_config.json\"), \" file (see the \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }, \"auth_config.json.example\"), \" file for an example of where it should go)\")), /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }, \"Once you have configured the value for \", /*#__PURE__*/React.createElement(\"code\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 54\n    }\n  }, \"audience\"), \", please restart the app and try to use the \\\"Ping API\\\" button below.\")), /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    className: \"mt-5\",\n    onClick: callApi,\n    disabled: !audience,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 9\n    }\n  }, \"Ping API\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"result-block-container\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }\n  }, state.showResult && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"result-block\",\n    \"data-testid\": \"api-result\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h6\", {\n    className: \"muted\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 13\n    }\n  }, \"Result\"), /*#__PURE__*/React.createElement(Highlight, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 15\n    }\n  }, JSON.stringify(state.apiMessage, null, 2))))));\n};\nexport default withAuthenticationRequired(ExternalApiComponent, {\n  onRedirecting: function onRedirecting() {\n    return /*#__PURE__*/React.createElement(Loading, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 24\n      }\n    });\n  }\n});","map":{"version":3,"sources":["/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/src/views/ExternalApi.js"],"names":["React","useState","Button","Alert","Highlight","useAuth0","withAuthenticationRequired","getConfig","Loading","ExternalApiComponent","apiOrigin","audience","showResult","apiMessage","error","state","setState","getAccessTokenSilently","loginWithPopup","getAccessTokenWithPopup","handleConsent","callApi","handleLoginAgain","token","fetch","headers","Authorization","response","json","responseData","handle","e","fn","preventDefault","JSON","stringify","onRedirecting"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { Button, Alert } from \"reactstrap\";\nimport Highlight from \"../components/Highlight\";\nimport { useAuth0, withAuthenticationRequired } from \"@auth0/auth0-react\";\nimport { getConfig } from \"../config\";\nimport Loading from \"../components/Loading\";\n\nexport const ExternalApiComponent = () => {\n  const { apiOrigin = \"http://localhost:3001\", audience } = getConfig();\n\n  const [state, setState] = useState({\n    showResult: false,\n    apiMessage: \"\",\n    error: null,\n  });\n\n  const {\n    getAccessTokenSilently,\n    loginWithPopup,\n    getAccessTokenWithPopup,\n  } = useAuth0();\n\n  const handleConsent = async () => {\n    try {\n      await getAccessTokenWithPopup();\n      setState({\n        ...state,\n        error: null,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n\n    await callApi();\n  };\n\n  const handleLoginAgain = async () => {\n    try {\n      await loginWithPopup();\n      setState({\n        ...state,\n        error: null,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n\n    await callApi();\n  };\n\n  const callApi = async () => {\n    try {\n      const token = await getAccessTokenSilently();\n\n      const response = await fetch(`${apiOrigin}/api/external`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      const responseData = await response.json();\n\n      setState({\n        ...state,\n        showResult: true,\n        apiMessage: responseData,\n      });\n    } catch (error) {\n      setState({\n        ...state,\n        error: error.error,\n      });\n    }\n  };\n\n  const handle = (e, fn) => {\n    e.preventDefault();\n    fn();\n  };\n\n  return (\n    <>\n      <div className=\"mb-5\">\n        {state.error === \"consent_required\" && (\n          <Alert color=\"warning\">\n            You need to{\" \"}\n            <a\n              href=\"#/\"\n              class=\"alert-link\"\n              onClick={(e) => handle(e, handleConsent)}\n            >\n              consent to get access to users api\n            </a>\n          </Alert>\n        )}\n\n        {state.error === \"login_required\" && (\n          <Alert color=\"warning\">\n            You need to{\" \"}\n            <a\n              href=\"#/\"\n              class=\"alert-link\"\n              onClick={(e) => handle(e, handleLoginAgain)}\n            >\n              log in again\n            </a>\n          </Alert>\n        )}\n\n        <h1>External API</h1>\n        <p className=\"lead\">\n          Ping an external API by clicking the button below.\n        </p>\n\n        <p>\n          This will call a local API on port 3001 that would have been started\n          if you run <code>npm run dev</code>. An access token is sent as part\n          of the request's `Authorization` header and the API will validate it\n          using the API's audience value.\n        </p>\n\n        {!audience && (\n          <Alert color=\"warning\">\n            <p>\n              You can't call the API at the moment because your application does\n              not have any configuration for <code>audience</code>, or it is\n              using the default value of <code>YOUR_API_IDENTIFIER</code>. You\n              might get this default value if you used the \"Download Sample\"\n              feature of{\" \"}\n              <a href=\"https://auth0.com/docs/quickstart/spa/react\">\n                the quickstart guide\n              </a>\n              , but have not set an API up in your Auth0 Tenant. You can find\n              out more information on{\" \"}\n              <a href=\"https://auth0.com/docs/api\">setting up APIs</a> in the\n              Auth0 Docs.\n            </p>\n            <p>\n              The audience is the identifier of the API that you want to call\n              (see{\" \"}\n              <a href=\"https://auth0.com/docs/get-started/dashboard/tenant-settings#api-authorization-settings\">\n                API Authorization Settings\n              </a>{\" \"}\n              for more info).\n            </p>\n\n            <p>\n              In this sample, you can configure the audience in a couple of\n              ways:\n            </p>\n            <ul>\n              <li>\n                in the <code>src/index.js</code> file\n              </li>\n              <li>\n                by specifying it in the <code>auth_config.json</code> file (see\n                the <code>auth_config.json.example</code> file for an example of\n                where it should go)\n              </li>\n            </ul>\n            <p>\n              Once you have configured the value for <code>audience</code>,\n              please restart the app and try to use the \"Ping API\" button below.\n            </p>\n          </Alert>\n        )}\n\n        <Button\n          color=\"primary\"\n          className=\"mt-5\"\n          onClick={callApi}\n          disabled={!audience}\n        >\n          Ping API\n        </Button>\n      </div>\n\n      <div className=\"result-block-container\">\n        {state.showResult && (\n          <div className=\"result-block\" data-testid=\"api-result\">\n            <h6 className=\"muted\">Result</h6>\n            <Highlight>\n              <span>{JSON.stringify(state.apiMessage, null, 2)}</span>\n            </Highlight>\n          </div>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default withAuthenticationRequired(ExternalApiComponent, {\n  onRedirecting: () => <Loading />,\n});\n"]},"metadata":{},"sourceType":"module"}
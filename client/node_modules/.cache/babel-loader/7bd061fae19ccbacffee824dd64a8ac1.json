{"ast":null,"code":"'use strict';\n\nvar _regeneratorRuntime = require(\"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar PDF = require('../object');\n\nvar Parser = require('../parser/parser');\n\nmodule.exports = /*#__PURE__*/function () {\n  function PDFImage(src) {\n    _classCallCheck(this, PDFImage);\n\n    var parser = new Parser(src);\n    parser.parse();\n    var catalog = parser.trailer.get('Root').object.properties;\n    var pages = catalog.get('Pages').object.properties;\n    var first = pages.get('Kids')[0].object.properties;\n    var mediaBox = first.get('MediaBox') || pages.get('MediaBox');\n    this.page = first;\n    this.width = mediaBox[2];\n    this.height = mediaBox[3];\n    var contents = this.page.get('Contents');\n    this.xobjCount = Array.isArray(contents) ? contents.length : 1;\n  }\n\n  _createClass(PDFImage, [{\n    key: \"write\",\n    value: function () {\n      var _write = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(doc, xobjs) {\n        var resources, bbox, i, xobj, contents, content, objects, _i, _objects, obj, _i2, _objects2, _obj;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                resources = this.page.get('Resources');\n                bbox = new PDF.Array([0, 0, this.width, this.height]);\n                i = 0;\n\n              case 3:\n                if (!(i < this.xobjCount)) {\n                  _context.next = 32;\n                  break;\n                }\n\n                xobj = xobjs[i];\n                xobj.prop('Subtype', 'Form');\n                xobj.prop('FormType', 1);\n                xobj.prop('BBox', bbox);\n                xobj.prop('Resources', resources instanceof PDF.Object ? resources.toReference() : resources);\n                contents = this.page.get('Contents');\n\n                if (Array.isArray(contents)) {\n                  contents = contents[i].object;\n                } else {\n                  contents = contents.object;\n                }\n\n                content = new PDF.Stream(xobj);\n                content.content = contents.content.content;\n\n                if (contents.properties.has('Filter')) {\n                  xobj.prop('Filter', contents.properties.get('Filter'));\n                }\n\n                xobj.prop('Length', contents.properties.get('Length'));\n\n                if (contents.properties.has('Length1')) {\n                  xobj.prop('Length1', contents.properties.get('Length1'));\n                }\n\n                objects = [];\n                Parser.addObjectsRecursive(objects, xobj); // first, register objects to assign IDs (for references)\n\n                for (_i = 0, _objects = objects; _i < _objects.length; _i++) {\n                  obj = _objects[_i];\n\n                  doc._registerObject(obj, true);\n                } // write objects\n\n\n                _i2 = 0, _objects2 = objects;\n\n              case 20:\n                if (!(_i2 < _objects2.length)) {\n                  _context.next = 27;\n                  break;\n                }\n\n                _obj = _objects2[_i2];\n                _context.next = 24;\n                return doc._writeObject(_obj);\n\n              case 24:\n                _i2++;\n                _context.next = 20;\n                break;\n\n              case 27:\n                _context.next = 29;\n                return doc._writeObject(xobj);\n\n              case 29:\n                ++i;\n                _context.next = 3;\n                break;\n\n              case 32:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function write(_x, _x2) {\n        return _write.apply(this, arguments);\n      }\n\n      return write;\n    }()\n  }]);\n\n  return PDFImage;\n}();","map":{"version":3,"sources":["/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/pdfjs/lib/image/pdf.js"],"names":["PDF","require","Parser","module","exports","src","parser","parse","catalog","trailer","get","object","properties","pages","first","mediaBox","page","width","height","contents","xobjCount","Array","isArray","length","doc","xobjs","resources","bbox","i","xobj","prop","Object","toReference","content","Stream","has","objects","addObjectsRecursive","obj","_registerObject","_writeObject"],"mappings":"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","sourcesContent":["'use strict'\n\nconst PDF = require('../object')\nconst Parser = require('../parser/parser')\n\nmodule.exports = class PDFImage {\n  constructor(src) {\n    const parser = new Parser(src)\n    parser.parse()\n\n    const catalog  = parser.trailer.get('Root').object.properties\n    const pages    = catalog.get('Pages').object.properties\n    const first    = pages.get('Kids')[0].object.properties\n    const mediaBox = first.get('MediaBox') || pages.get('MediaBox')\n\n    this.page = first\n    this.width = mediaBox[2]\n    this.height = mediaBox[3]\n\n    const contents = this.page.get('Contents')\n    this.xobjCount = Array.isArray(contents) ? contents.length : 1\n  }\n\n  async write(doc, xobjs) {\n    const resources = this.page.get('Resources')\n    const bbox = new PDF.Array([0, 0, this.width, this.height])\n\n    for (let i = 0; i < this.xobjCount; ++i) {\n      const xobj = xobjs[i]\n\n      xobj.prop('Subtype', 'Form')\n      xobj.prop('FormType', 1)\n      xobj.prop('BBox', bbox)\n      xobj.prop('Resources', resources instanceof PDF.Object ? resources.toReference() : resources)\n\n      let contents = this.page.get('Contents')\n      if (Array.isArray(contents)) {\n        contents = contents[i].object\n      } else {\n        contents = contents.object\n      }\n\n      const content = new PDF.Stream(xobj)\n      content.content = contents.content.content\n\n      if (contents.properties.has('Filter')) {\n        xobj.prop('Filter', contents.properties.get('Filter'))\n      }\n      xobj.prop('Length',  contents.properties.get('Length'))\n      if (contents.properties.has('Length1')) {\n        xobj.prop('Length1', contents.properties.get('Length1'))\n      }\n\n      const objects = []\n      Parser.addObjectsRecursive(objects, xobj)\n\n      // first, register objects to assign IDs (for references)\n      for (const obj of objects) {\n        doc._registerObject(obj, true)\n      }\n\n      // write objects\n      for (const obj of objects) {\n        await doc._writeObject(obj)\n      }\n\n      await doc._writeObject(xobj)\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"script"}
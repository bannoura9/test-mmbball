{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{flattenDeep,groupBy}from\"lodash\";import InfiniteScroll from\"react-infinite-scroll-component\";import VideoLibraryHeader from\"./modules/video-library-header\";import RecentlyAdded from\"../components/modules/recently-added\";import mockData from\"../data.json\";var playlistIds=[\"PLtAzkECGU1yXDNefSuSbxODu9hrRK0UtP\",\"PLtAzkECGU1yXhKBF1t-pJmH8S1nuBiu8z\"];var VideoLibrary=function VideoLibrary(_ref){var isHomepage=_ref.isHomepage;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),playlists=_useState2[0],setPlaylists=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),videos=_useState4[0],setVideos=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),videosCopy=_useState6[0],setVideosCopy=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),hasMore=_useState8[0],setHasMore=_useState8[1];var pageSize=10;useEffect(function(){if(videos.length&&videos.length===videosCopy.length)setHasMore(false);},[videos.length]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var playlistRes,playlistResJsOn,playlistItemsResJsOn,filteredVideos;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"https://www.googleapis.com/youtube/v3/playlists?\"+new URLSearchParams({key:\"AIzaSyCAH8cKrD6ASDhtfMYIfEGzNU6v9mcltRI\",part:\"id,snippet\",id:playlistIds.join(\",\")}));case 3:playlistRes=_context2.sent;_context2.next=6;return playlistRes.json();case 6:playlistResJsOn=_context2.sent;setPlaylists(playlistResJsOn.items.map(function(_ref3){var id=_ref3.id,snippet=_ref3.snippet;return{id:id,title:snippet.localized.title};}));_context2.next=10;return Promise.all(playlistIds.map(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(playlistId){var playlistItemsRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"https://www.googleapis.com/youtube/v3/playlistItems?\"+new URLSearchParams({part:\"snippet\",key:\"AIzaSyCAH8cKrD6ASDhtfMYIfEGzNU6v9mcltRI\",channelId:\"UCHBDAkjxufCaEfmRaf7Bj3Q\",maxResults:200,playlistId:playlistId}));case 2:playlistItemsRes=_context.sent;return _context.abrupt(\"return\",playlistItemsRes.json());case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref4.apply(this,arguments);};}()));case 10:playlistItemsResJsOn=_context2.sent;filteredVideos=flattenDeep(playlistItemsResJsOn.map(function(playlistItems){return playlistItems.items.map(function(i){return i.snippet;});})).sort(function(a,b){return a.publishedAt>b.publishedAt?1:-1;});filteredVideos=isHomepage?filteredVideos.slice(0,6):filteredVideos;setVideos(filteredVideos.slice(0,pageSize));setVideosCopy(filteredVideos);//   setPlaylists(mockData.playlists);\n//   setVideos(mockData.videos);\n//   setVideosCopy(mockData.videos);\n_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](0);console.log(\"err==>>\",_context2.t0);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[0,17]]);}))();},[]);var filterVideos=function filterVideos(e){var value=e.target.value;if(value){setVideos(videosCopy.filter(function(v){return v.playlistId===value;}));}else{setVideos(videosCopy);}};var fetchData=function fetchData(){console.log(\"\".concat(videos.length,\" loaded!\"),\"loading \".concat(pageSize,\" videos more\"));setVideos(function(vids){return videosCopy.slice(0,vids.length+10);});};var refresh=function refresh(){};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"container dashOpacity mt-1 mb-5\"},/*#__PURE__*/React.createElement(\"div\",{id:\"video-wrapper\",className:\"card mb-1\"},/*#__PURE__*/React.createElement(VideoLibraryHeader,{filterVideos:filterVideos,playlists:playlists}),/*#__PURE__*/React.createElement(InfiniteScroll,{dataLength:videos.length//This is important field to render the next data\n,next:fetchData,hasMore:hasMore,loader:/*#__PURE__*/React.createElement(\"h4\",null,\"Loading...\"),endMessage:/*#__PURE__*/React.createElement(\"p\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(\"b\",null,\"Yay! You have seen it all\"))// below props only if you need pull down functionality\n,refreshFunction:refresh,pullDownToRefresh:true,pullDownToRefreshThreshold:50,pullDownToRefreshContent:/*#__PURE__*/React.createElement(\"h3\",{style:{textAlign:\"center\"}},\"\\u2193 Pull down to refresh\"),releaseToRefreshContent:/*#__PURE__*/React.createElement(\"h3\",{style:{textAlign:\"center\"}},\"\\u2191 Release to refresh\")},/*#__PURE__*/React.createElement(\"div\",{className:\"video-container\"},videos.map(function(video,i){return/*#__PURE__*/React.createElement(\"div\",{key:i,className:\"video\"},/*#__PURE__*/React.createElement(\"iframe\",{width:\"100%\",height:\"100%\",src:\"https://www.youtube.com/embed/\".concat(video.resourceId.videoId),frameBorder:\"0\",allow:\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\",allowFullScreen:true}));}))))));};export default VideoLibrary;","map":{"version":3,"sources":["/Users/mikebannoura/Dropbox/My Mac (MacBook-Pro-Mike.local)/Desktop/mmbball-app/client/src/components/video-library.jsx"],"names":["React","useEffect","useState","flattenDeep","groupBy","InfiniteScroll","VideoLibraryHeader","RecentlyAdded","mockData","playlistIds","VideoLibrary","isHomepage","playlists","setPlaylists","videos","setVideos","videosCopy","setVideosCopy","hasMore","setHasMore","pageSize","length","fetch","URLSearchParams","key","part","id","join","playlistRes","json","playlistResJsOn","items","map","snippet","title","localized","Promise","all","playlistId","channelId","maxResults","playlistItemsRes","playlistItemsResJsOn","filteredVideos","playlistItems","i","sort","a","b","publishedAt","slice","console","log","filterVideos","e","value","target","filter","v","fetchData","vids","refresh","textAlign","video","resourceId","videoId"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { flattenDeep, groupBy } from \"lodash\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport VideoLibraryHeader from \"./modules/video-library-header\";\nimport RecentlyAdded from \"../components/modules/recently-added\";\nimport mockData from \"../data.json\";\n\nconst playlistIds = [\n  \"PLtAzkECGU1yXDNefSuSbxODu9hrRK0UtP\",\n  \"PLtAzkECGU1yXhKBF1t-pJmH8S1nuBiu8z\",\n];\n\nconst VideoLibrary = ({ isHomepage }) => {\n  const [playlists, setPlaylists] = useState([]);\n  const [videos, setVideos] = useState([]);\n  const [videosCopy, setVideosCopy] = useState([]);\n  const [hasMore, setHasMore] = useState(true);\n  const pageSize = 10;\n\n  useEffect(() => {\n    if (videos.length && videos.length === videosCopy.length) setHasMore(false);\n  }, [videos.length]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const playlistRes = await fetch(\n          \"https://www.googleapis.com/youtube/v3/playlists?\" +\n            new URLSearchParams({\n              key: \"AIzaSyCAH8cKrD6ASDhtfMYIfEGzNU6v9mcltRI\",\n              part: \"id,snippet\",\n              id: playlistIds.join(\",\"),\n            })\n        );\n        const playlistResJsOn = await playlistRes.json();\n        setPlaylists(\n          playlistResJsOn.items.map(({ id, snippet }) => ({\n            id,\n            title: snippet.localized.title,\n          }))\n        );\n\n        const playlistItemsResJsOn = await Promise.all(\n          playlistIds.map(async (playlistId) => {\n            const playlistItemsRes = await fetch(\n              \"https://www.googleapis.com/youtube/v3/playlistItems?\" +\n                new URLSearchParams({\n                  part: \"snippet\",\n                  key: \"AIzaSyCAH8cKrD6ASDhtfMYIfEGzNU6v9mcltRI\",\n                  channelId: \"UCHBDAkjxufCaEfmRaf7Bj3Q\",\n                  maxResults: 200,\n                  playlistId,\n                })\n            );\n            return playlistItemsRes.json();\n          })\n        );\n\n        let filteredVideos = flattenDeep(\n          playlistItemsResJsOn.map((playlistItems) =>\n            playlistItems.items.map((i) => i.snippet)\n          )\n        ).sort((a, b) => (a.publishedAt > b.publishedAt ? 1 : -1));\n\n        filteredVideos = isHomepage\n          ? filteredVideos.slice(0, 6)\n          : filteredVideos;\n\n        setVideos(filteredVideos.slice(0, pageSize));\n        setVideosCopy(filteredVideos);\n        //   setPlaylists(mockData.playlists);\n        //   setVideos(mockData.videos);\n        //   setVideosCopy(mockData.videos);\n      } catch (err) {\n        console.log(\"err==>>\", err);\n      }\n    })();\n  }, []);\n\n  const filterVideos = (e) => {\n    const { value } = e.target;\n    if (value) {\n      setVideos(videosCopy.filter((v) => v.playlistId === value));\n    } else {\n      setVideos(videosCopy);\n    }\n  };\n\n  const fetchData = () => {\n    console.log(`${videos.length} loaded!`, `loading ${pageSize} videos more`);\n    setVideos((vids) => videosCopy.slice(0, vids.length + 10));\n  };\n\n  const refresh = () => {};\n\n  return (\n    <div>\n      <div className=\"container dashOpacity mt-1 mb-5\">\n        <div id=\"video-wrapper\" className=\"card mb-1\">\n          <VideoLibraryHeader\n            filterVideos={filterVideos}\n            playlists={playlists}\n          />\n\n          <InfiniteScroll\n            dataLength={videos.length} //This is important field to render the next data\n            next={fetchData}\n            hasMore={hasMore}\n            loader={<h4>Loading...</h4>}\n            endMessage={\n              <p style={{ textAlign: \"center\" }}>\n                <b>Yay! You have seen it all</b>\n              </p>\n            }\n            // below props only if you need pull down functionality\n            refreshFunction={refresh}\n            pullDownToRefresh\n            pullDownToRefreshThreshold={50}\n            pullDownToRefreshContent={\n              <h3 style={{ textAlign: \"center\" }}>\n                &#8595; Pull down to refresh\n              </h3>\n            }\n            releaseToRefreshContent={\n              <h3 style={{ textAlign: \"center\" }}>\n                &#8593; Release to refresh\n              </h3>\n            }\n          >\n            <div className=\"video-container\">\n              {videos.map((video, i) => (\n                <div key={i} className=\"video\">\n                  <iframe\n                    width=\"100%\"\n                    height=\"100%\"\n                    src={`https://www.youtube.com/embed/${video.resourceId.videoId}`}\n                    frameBorder=\"0\"\n                    allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                    allowFullScreen\n                  ></iframe>\n                </div>\n              ))}\n            </div>\n          </InfiniteScroll>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VideoLibrary;\n"]},"metadata":{},"sourceType":"module"}